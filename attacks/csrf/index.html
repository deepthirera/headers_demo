
<!DOCTYPE html>
<html>
<body>

<h2>Using the XMLHttpRequest Object</h2>

<div id="demo">
<button type="button" onclick="allowOrigin()">View posts</button>
<button type="button" onclick="loadBlogPosts()">Create a post</button>
</div>
<!-- <a href="http://localhost:9090/WebGoat/csrf/basic-get-flag">Lesson1</a>
<button type="button" onclick="lesson2()">Lesson2</button>
 -->
<script>
// function loadXMLDoc() {
//   var xhttp = new XMLHttpRequest();
//   xhttp.onreadystatechange = function() {
// 		if (this.readyState == 4 && this.status == 200) {
// 			document.getElementById("demo").innerHTML = this.responseText;
// 		}
// 	};
//   xhttp.open("GET", "https://api.artsy.net/api/users/5aab9c81a09a671deaf364f1", true);
//   xhttp.withCredentials = true;
//   xhttp.send();
// };

function loadBlogPosts() {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
  		console.log(document.cookie);
		if (this.readyState == 4 && this.status == 200) {
			document.getElementById("demo").innerHTML = this.responseText;
		}
	};
  xhttp.open("POST", "http://www.mywebsite.org/posts", true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.withCredentials = true;
  xhttp.send("post[title]=Deepthi&post[content]=Ford");
};

function allowOrigin() {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
  		console.log(document.cookie);
		if (this.readyState == 4 && this.status == 200) {
			document.getElementById("demo").innerHTML = this.responseText;
		}
	};
  xhttp.open("GET", "http://www.mywebsite.org/posts", true);
  xhttp.withCredentials = true;
  xhttp.send();
};

// function lesson2() {
//   var xhttp = new XMLHttpRequest();
// 	var postdata= "reviewText=deepthi&stars=5"; //Probably need the escape method for values here, like you did
//   xhttp.onreadystatechange = function() {
// 		if (this.readyState == 4 && this.status == 200) {
// 			document.getElementById("demo").innerHTML = this.responseText;
// 		}
// 	};
//   xhttp.open("POST", "http://localhost:9090/WebGoat/csrf/review", true);
//   xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
// 	xhttp.setRequestHeader("Content-length", postdata.length);

//   xhttp.withCredentials = true;
//   xhttp.send(postdata);
// };
</script>

</body>
</html>
